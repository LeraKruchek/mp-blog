function ngReallyClick(a){var b=function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}};return{restrict:"A",scope:{ngReallyClick:"&"},link:function(c,d,e){d.bind("click",function(){var d=e.message,f='<div class="modal-body">'+d+"</div>";f+='<div class="modal-footer"><button class="btn-result" ng-click="ok()">OK</button><button class="btn-result" ng-click="cancel()">Cancel</button></div>';var g=a.open({template:f,controller:b});g.result.then(function(){c.ngReallyClick()},function(){})})}}}!function(){angular.module("blog-app",["ui.router","admin-app","confirm-app","blog-app.directives","blog-app.controllers","blog-app.filters"]).config(["$locationProvider","$stateProvider","$urlRouterProvider",function(a,b,c){a.html5Mode(!0),c.otherwise("/"),b.state("anon",{"abstract":!0,template:"<ui-view/>"}).state("anon.firstPost",{url:"/",controller:"FirstPostController",controllerAs:"FirstPostController",templateUrl:"/public/dist/templates/anon/first-post.html"}).state("anon.post",{url:"/articles/:id",controller:"PostController",controllerAs:"PostCtrl",templateUrl:"/public/dist/templates/anon/single-post.html"}).state("anon.login",{url:"/login",controller:"LoginController",controllerAs:"LoginCtrl",templateUrl:"/public/dist/templates/anon/login-page.html"}).state("anon.archive",{url:"/archive",controller:"ArchiveController",controllerAs:"ArchiveCtrl",templateUrl:"/public/dist/templates/anon/archive-page.html"}),b.state("admin",{"abstract":!0,controller:"",template:"<ui-view/>",data:{auth:!0}}).state("admin.archive",{controller:"AdminController",controllerAs:"AdminCtrl",url:"/admin/archive",templateUrl:"/public/dist/templates/admin/admin-archive.html"}).state("admin.new",{url:"/admin/new",controller:"NewPostController",controllerAs:"NewPostCtrl",templateUrl:"/public/dist/templates/admin/admin-new.html"}).state("admin.edit",{url:"/admin/edit/:visible_id",controller:"EditPostController",controllerAs:"EditPostCtrl",templateUrl:"/public/dist/templates/admin/admin-edit.html"})}]).run(["$rootScope","$state","AuthService","$anchorScroll",function(a,b,c,d){a.$on("$stateChangeStart",function(a,e){d();var f=c.getInfo();"anon.login"===e.name&&f&&(a.preventDefault(),b.go("admin.archive")),e.data&&(f||(a.preventDefault(),b.go("anon.login")))})}])}(),function(){angular.module("admin-app.controllers",["admin-app.services","blog-app.filters"])}(),function(){function a(a){var b=this;b.posts=[],a.getPosts().then(function(a){b.posts=a}),b.deletePost=function(c,d){a.deletePost(c).then(function(){b.posts.splice(d,1)})},b.hi=function(a){console.log(a)}}angular.module("admin-app.controllers").controller("AdminController",a),a.$inject=["AdminPostFactory","$scope"]}(),function(){function a(a,b,c){var d=this,e=b.visible_id;d.decodeEntities=function(a){return a.replace(/&amp;/g,"&").replace(/&#\d+;/g,function(a){var b=a.match(/\d+/g);return String.fromCharCode(b[0])})},a.getPost(e).then(function(a){d.post=a[0],d.post.output=d.decodeEntities(d.post.output),d.state="visible"===d.post.state?!1:!0}),d.savePost=function(){d.post.output=c(d.post.output),d.post.state=d.state?"hidden":"visible",a.savePost(d.post._id,d.post).then(function(a){console.log(a)})}}angular.module("admin-app.controllers").controller("EditPostController",a),a.$inject=["AdminPostFactory","$stateParams","$sanitize","$sce","$filter","$parse"]}(),function(){function a(a,b){var c=this;c.req={},c.login=function(){c.req.name=c.name,c.req.password=c.password,a.login(c.req).then(function(){c.req={},b.go("admin.archive")})},c.logout=function(){a.logout(),b.go("anon.login")}}angular.module("admin-app.controllers").controller("LoginController",a),a.$inject=["AuthService","$state"]}(),function(){function a(a,b,c){var d=this;d.newPost={},d.newPost.date="",d.newPost.output="",d.addPost=function(){d.newPost.output=c(d.newPost.output),d.newPost.state?d.newPost.state="draft":(d.newPost.state="visible",d.newPost.date=new Date),a.addPost(d.newPost).then(function(a){d.newPost={},console.log(a),b.go("admin.archive")})}}angular.module("admin-app.controllers").controller("NewPostController",a),a.$inject=["AdminPostFactory","$state","$sanitize"]}(),function(){angular.module("blog-app.controllers",["blog-app.services","blog-app.filters"])}(),function(){function a(a){var b=this;b.posts=[],a.getPosts().then(function(a){b.posts=a})}angular.module("blog-app.controllers").controller("ArchiveController",a),a.$inject=["PostFactory"]}(),function(){function a(a,b){var c=this;c.posts=[],b.getPosts().then(function(a){c.posts=a})}angular.module("blog-app.controllers").controller("FirstPostController",a),a.$inject=["$scope","PostFactory"]}(),function(){function a(a,b,c,d){var e=this,f=c.id;console.log(d.path()),console.log(d.search()),e.posts=[],b.getPosts().then(function(a){e.posts=a,e.currentPost=e.posts.filter(function(a){return a.visible_id===f}),e.currentPost=e.currentPost[0],e.nextPost=e.posts[e.posts.indexOf(e.currentPost)+1],e.previousPost=e.posts[e.posts.indexOf(e.currentPost)-1]})}angular.module("blog-app.controllers").controller("PostController",a),a.$inject=["$scope","PostFactory","$stateParams","$location"]}(),function(){function a(a){return{restrict:"A",scope:{ngAddP:"@"},link:function(b,c){c.bind("click",function(){var c=(b.ngAddP,"<p>1</p>");b.$apply(a.trustAsHtml(b.$parent.NewPostCtrl.newPost.output+=c))})}}}angular.module("admin-app.directives",[]).directive("ngAddP",a),a.$inject=["$sce"]}(),function(){function a(){return{restrict:"A",scope:{ngBackImageOverlay:"@"},link:function(a,b,c){c.$observe("ngBackImageOverlay",function(a){b.css({"background-image":"linear-gradient(rgba(46, 48, 57, 0.75), rgba(46, 48, 57, 0.75)),url("+a+")","background-size":"cover"})})}}}function b(){return{restrict:"A",scope:{ngBackImage:"@"},link:function(a,b,c){c.$observe("ngBackImage",function(a){b.css({"background-image":"url("+a+")","background-size":"cover"})})}}}function c(){return{restrict:"E",replace:!0,templateUrl:"/public/dist/templates/partials/nav-primary.html"}}angular.module("blog-app.directives",[]).directive("ngBackImage",b).directive("ngBackImageOverlay",a).directive("navPrimary",c)}(),function(){function a(){return function(a){var b=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],c=new Date(a);return"1970"==c.getFullYear()?"Черновик":c.getDate()+" "+b[c.getMonth()]+", "+c.getFullYear()}}function b(a){return function(b){return a.trustAsHtml(b)}}angular.module("blog-app.filters",[]).filter("rusDate",a).filter("unsafe",b),b.$inject=["$sce"]}(),function(){angular.module("admin-app",["admin-app.controllers","admin-app.directives","confirm-app","ngSanitize","blog-app.filters"])}(),angular.module("confirm-app",["ui.bootstrap"]).directive("ngReallyClick",ngReallyClick),ngReallyClick.$inject=["$modal"],function(){function a(a,b,c){function d(){c.sessionStorage.userInfo&&(e.userInfo=JSON.parse(c.sessionStorage.userInfo))}var e={};return e.login=function(d){var f=b.defer();return a.post("/api/login",d).success(function(a){e.userInfo={accessToken:a.access_token,userName:a.userName},c.sessionStorage.userInfo=JSON.stringify(e.userInfo),f.resolve(a)}).error(function(a){f.reject(a),console.log(a)}),f.promise},e.logout=function(){e.userInfo=null,c.sessionStorage.userInfo=null},e.getInfo=function(){return e.userInfo},d(),e}function b(a,b,c){var d={},e=c.getInfo();return a.defaults.headers.get={access_token:e.accessToken},a.defaults.headers["delete"]={access_token:e.accessToken},a.defaults.headers.post={access_token:e.accessToken},a.defaults.headers.put={access_token:e.accessToken},a.defaults.headers.post["Content-Type"]="application/json",a.defaults.headers.put["Content-Type"]="application/json",d.getPosts=function(){var c=b.defer();return a.get("api/admin/posts").success(function(a){c.resolve(a)}).error(function(){c.reject()}),c.promise},d.getPost=function(c){var d=b.defer();return a.get("api/admin/post/"+c).success(function(a){d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},d.deletePost=function(c){var d=b.defer();return a["delete"]("api/admin/delete/"+c).success(function(a){d.resolve(a)}).error(function(){d.reject()}),d.promise},d.addPost=function(c){var d=b.defer();return a.post("api/admin/posts",c).success(function(a){d.resolve(a)}).error(function(){d.reject()}),d.promise},d.savePost=function(c,d){var e=b.defer();return a.put("api/admin/post/"+c,d).success(function(a){e.resolve(a)}).error(function(){e.reject()}),e.promise},d}angular.module("admin-app.services",[]).factory("AuthService",a).factory("AdminPostFactory",b),a.$inject=["$http","$q","$window"],b.$inject=["$http","$q","AuthService"]}(),function(){function a(a,b){var c={};return c.getPosts=function(){var c=b.defer();return a.get("/api/anon/posts").success(function(a){c.resolve(a)}).error(function(){console.log("error")}),c.promise},c}angular.module("blog-app.services",[]).factory("PostFactory",a),a.$inject=["$http","$q"]}();